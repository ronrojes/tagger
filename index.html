<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Catholic Tag Master v4.0 (Enhanced)</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; padding: 20px; background: #f0f4f8; color: #2d3436; }
        .container { max-width: 850px; margin: auto; background: white; padding: 30px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        h2 { color: #2c3e50; border-bottom: 3px solid #f1c40f; padding-bottom: 10px; margin-top: 0; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 15px; }
        label { font-weight: bold; font-size: 0.85em; display: block; margin-bottom: 5px; color: #636e72; }
        input, select, textarea { width: 100%; padding: 12px; border: 1px solid #dfe6e9; border-radius: 6px; box-sizing: border-box; font-size: 14px; transition: 0.2s; }
        input:focus, textarea:focus { border-color: #0984e3; outline: none; background: #fff; }
        .btn-group { display: flex; gap: 10px; margin-top: 20px; }
        button { flex: 1; padding: 14px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; transition: 0.2s; font-size: 14px; }
        #btnGen { background: #0984e3; color: white; }
        #btnCopy { background: #00b894; color: white; }
        #btnClear { background: #d63031; color: white; max-width: 130px; }
        button:hover { opacity: 0.8; transform: translateY(-1px); }
        .stats { font-size: 0.8em; font-weight: bold; color: #0984e3; margin-bottom: 5px; text-align: right; }
        #result { background: #fdf2f2; color: #d63031; font-family: 'Courier New', monospace; border: 2px dashed #fab1a0; font-weight: bold; }
        .topic-box { background: #f9f9f9; padding: 15px; border-radius: 8px; border: 1px solid #eee; margin-bottom: 15px; }
    </style>
</head>
<body>

<div class="container">
    <h2>Catholic Media Tag Master v4.0</h2>

    <div class="form-row">
        <div><label>Program Name</label><input type="text" id="program" placeholder="e.g. Life of Prayer?"></div>
        <div><label>Episode Title</label><input type="text" id="episode" placeholder="e.g. Mary's "Yes""></div>
    </div>

    <div class="topic-box">
        <label>Additional Topics / Subjects (Comma separated)</label>
        <input type="text" id="extraTopics" placeholder="e.g. Lent/Easter, St. Paul, Mercy!">
    </div>

    <div class="form-row">
        <div>
            <label>Religious Title</label>
            <select id="mainTitle">
                <option value="none">Layperson (No Title)</option>
                <option value="priest">Priest (Father / Fr)</option>
                <option value="nun">Nun (Sister / Sr)</option>
                <option value="mother">Mother Superior (Mother / Mo)</option>
                <option value="deacon">Deacon (Dcn / Deacon)</option>
                <option value="msgr">Monsignor (Msgr)</option>
                <option value="pastor">Pastor</option>
                <option value="bishop">Bishop (Bp / Bishop)</option>
                <option value="saint">Saint (St)</option>
            </select>
        </div>
        <div>
            <label>Academic / Professional</label>
            <select id="extraTitle">
                <option value="none">None</option>
                <option value="dr">Doctor (Dr)</option>
                <option value="churchdoc">Doctor of the Church</option>
            </select>
        </div>
    </div>

    <label>Names (One per line)</label>
    <textarea id="bulkNames" rows="3" placeholder="Enter Full Name(s)"></textarea>

    <label>Religious Order</label>
    <input type="text" id="order" placeholder="e.g. S.J., O.P.">

    <div class="btn-group">
        <button id="btnClear">RESET ALL</button>
        <button id="btnGen">GENERATE TAGS</button>
        <button id="btnCopy">COPY CLIPBOARD</button>
    </div>

    <hr style="margin: 25px 0; border: 0; border-top: 1px solid #eee;">
    <div class="stats" id="tagCount">Tags: 0</div>
    <textarea id="result" rows="8" readonly placeholder="Final tags appear here..."></textarea>
</div>

<script>
    window.onload = function() {
        const btnGen = document.getElementById('btnGen');
        const btnClear = document.getElementById('btnClear');
        const btnCopy = document.getElementById('btnCopy');

        // Clean version (alphanumeric and hyphens only)
        function slugify(text) {
            return text.trim().toLowerCase()
                .replace(/\s+/g, '-')
                .replace(/[^\w\-]+/g, '')
                .replace(/\-\-+/g, '-');
        }

        // Special character version (keeps symbols, just replaces spaces with hyphens)
        function preserveSpecial(text) {
            return text.trim().toLowerCase()
                .replace(/\s+/g, '-')
                .replace(/\-\-+/g, '-');
        }

        btnGen.addEventListener('click', function() {
            const program = document.getElementById('program').value;
            const episode = document.getElementById('episode').value;
            const topics = document.getElementById('extraTopics').value.split(',');
            const namesRaw = document.getElementById('bulkNames').value.split('\n');
            const mainTitle = document.getElementById('mainTitle').value;
            const extraTitle = document.getElementById('extraTitle').value;
            const globalOrder = document.getElementById('order').value.trim();

            let finalTags = [];

            function addDualTags(val) {
                if(!val.trim()) return;
                finalTags.push(slugify(val));
                finalTags.push(preserveSpecial(val));
            }

            // 1. Program & Episode
            if (program) addDualTags(program);
            if (episode) addDualTags(episode);

            // 2. General Topics
            topics.forEach(t => {
                if(t.trim()) addDualTags(t);
            });

            // 3. Names Processing
            namesRaw.forEach(nameLine => {
                let name = nameLine.trim();
                if (!name) return;

                let nameSlug = slugify(name);
                let nameSpec = preserveSpecial(name);
                let last = name.split(" ").pop();
                let lastSlug = slugify(last);

                let titles = [];
                if (mainTitle === 'priest') titles = ['Father', 'Fr'];
                else if (mainTitle === 'nun') titles = ['Sister', 'Sr'];
                else if (mainTitle === 'mother') titles = ['Mother', 'Mo'];
                else if (mainTitle === 'deacon') titles = ['Deacon', 'Dcn'];
                else if (mainTitle === 'msgr') titles = ['Monsignor', 'Msgr'];
                else if (mainTitle === 'pastor') titles = ['Pastor'];
                else if (mainTitle === 'bishop') titles = ['Bishop', 'Bp'];
                else if (mainTitle === 'saint') titles = ['Saint', 'St'];

                let extras = [];
                if (extraTitle === 'dr') extras = ['Dr', 'Doctor'];
                else if (extraTitle === 'churchdoc') extras = ['Doctor-of-the-Church'];

                // Base names
                finalTags.push(nameSlug, nameSpec);

                // Add Order (Clean and Special)
                if (globalOrder) {
                    finalTags.push(`${nameSlug}-${slugify(globalOrder)}`);
                    finalTags.push(`${nameSpec}-${preserveSpecial(globalOrder)}`);
                }

                // Title + Name combinations
                titles.forEach(t => {
                    let tLow = t.toLowerCase();
                    finalTags.push(`${tLow}-${nameSlug}`, `${tLow}-${nameSpec}`);
                    finalTags.push(`${tLow}-${lastSlug}`);
                    
                    if (globalOrder) {
                        finalTags.push(`${tLow}-${nameSlug}-${slugify(globalOrder)}`);
                        finalTags.push(`${tLow}-${nameSpec}-${preserveSpecial(globalOrder)}`);
                    }
                    
                    extras.forEach(ex => {
                        let exLow = ex.toLowerCase();
                        finalTags.push(`${exLow}-${tLow}-${nameSlug}`, `${exLow}-${tLow}-${nameSpec}`);
                        finalTags.push(`${exLow}-${nameSlug}`, `${exLow}-${nameSpec}`);
                    });
                });

                // Academic Title Only
                if (mainTitle === 'none' && extras.length > 0) {
                    extras.forEach(ex => {
                        let exLow = ex.toLowerCase();
                        finalTags.push(`${exLow}-${nameSlug}`, `${exLow}-${nameSpec}`);
                        finalTags.push(`${exLow}-${lastSlug}`);
                    });
                }
            });

            // Cleanup: remove duplicates and empty strings
            let uniqueTags = [...new Set(finalTags.filter(t => t && t !== '-'))];
            document.getElementById('result').value = uniqueTags.join(', ');
            document.getElementById('tagCount').innerText = 'Tags Generated: ' + uniqueTags.length;
        });

        btnClear.addEventListener('click', function() {
            if(confirm("Clear all data for next video?")) {
                location.reload();
            }
        });

        btnCopy.addEventListener('click', function() {
            let res = document.getElementById("result");
            if(!res.value) return;
            res.select();
            document.execCommand("copy");
            alert("Tags copied to clipboard!");
        });
    };
</script>
</body>
</html>
